@startuml
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 14
skinparam componentStyle rectangle
skinparam linetype polyline
skinparam nodesep 80
skinparam ranksep 80

title Online Advertising System Architecture - Optimized Version
caption Core Components, Key Processes, and Optimization Points

rectangle "Client Side" {
    [Advertiser] as Advertiser
    [User] as User
    [Website/App] as Publisher
}

rectangle "Core Services" {
    [Ad Management] as AdManagement
    [User Analysis] as UserAnalysis
    [Ad Matching Engine] as AdMatching
    [Real-Time Bidding] as RTB
}

rectangle "Data Processing & Storage" {
    [Data Pipeline] as DataPipeline
    database "Data Storage" as DataStorage
}

Advertiser -[thickness=2]d-> AdManagement : "1. Create Ad"
User -[thickness=2]r-> Publisher : "2. Browse"
Publisher -[thickness=2]d-> AdMatching : "3. Request Ad"
AdMatching -[thickness=2]r-> RTB : "4. Trigger Bidding"
RTB -[thickness=2]l-> AdMatching : "5. Select Ad"
AdMatching -[thickness=2]u-> Publisher : "6. Serve Ad"
User -[thickness=2]d-> DataPipeline : "7. User Behavior"
DataPipeline -[thickness=2]r-> DataStorage : "8. Store Data"
UserAnalysis <-[thickness=2]u- DataStorage : "9. Analyze Data"
AdMatching <-[thickness=2]l- UserAnalysis : "10. Optimize Matching"

note right of RTB
  Optimization: 
  - Use distributed system
  - Implement caching
  - Optimize algorithms
end note

note bottom of AdMatching
  Key Component:
  - Implement ML models
  - Use predictive analytics
  - Ensure low latency
end note

note left of DataPipeline
  Scalability:
  - Use stream processing
  - Implement data sharding
  - Consider data compression
end note

note top of UserAnalysis
  Privacy & Security:
  - Implement data anonymization
  - Ensure GDPR compliance
  - Use encryption for sensitive data
end note

@enduml