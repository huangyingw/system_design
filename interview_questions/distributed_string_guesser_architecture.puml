@startuml
skinparam backgroundColor #D3D3D3

package "Private Cloud Compute Nodes" {
    [Central Coordination Node] as Coordinator
    frame "Apache Spark Cluster" {
        [Distributed Producer Node 1 (Range A)] as DistProducer1
        [Distributed Producer Node 2 (Range B)] as DistProducer2
        [Kubernetes Autoscaler] as Autoscaler
        [Consumer Node 3 (Dynamic)] as DynamicConsumer3
    }
    [Central Pub/Sub Messaging System] as PubSub
}

package "Free Compute Resources Nodes" {
    [Consumer Node 1] as FreeConsumer1
    [Consumer Node 2] as FreeConsumer2
}
    
[RESTful Thread API] as API

Autoscaler --> PubSub : Monitor Queue Length
Autoscaler --> DistProducer1 : Scale In/Out
Autoscaler --> DistProducer2 : Scale In/Out
Autoscaler --> DynamicConsumer3 : Scale In/Out

Coordinator --> DistProducer1 : Assign Range & Manage
Coordinator --> DistProducer2 : Assign Range & Manage
Coordinator --> PubSub : Manage
    
DistProducer1 --> PubSub : Publish Strings
DistProducer2 --> PubSub : Publish Strings

PubSub --> FreeConsumer1 : Subscribe & Get Strings
PubSub --> FreeConsumer2 : Subscribe & Get Strings
PubSub --> DynamicConsumer3 : Subscribe & Get Strings

FreeConsumer1 --> API : Validate String
FreeConsumer2 --> API : Validate String
DynamicConsumer3 --> API : Validate String

API --> FreeConsumer1 : Return Status Code
API --> FreeConsumer2 : Return Status Code
API --> DynamicConsumer3 : Return Status Code

Coordinator -up-> [Stop Signal] : If Correct String Found

@enduml
