@startuml

skinparam backgroundColor #D3D3D3
skinparam defaultFontName "Arial"
skinparam defaultFontSize 16
skinparam note {
    BackgroundColor #FFFFFF
        BorderColor #000000
        FontSize 16
        FontName "Arial"
}

title Twitter Search Service Architecture

rectangle "Client" as Client

rectangle "Search Service" as Search {
    rectangle "Request Handler" as RH
        rectangle "Query Parser" as QP
        rectangle "Index Query" as IQ
        rectangle "Result Handler" as RHdl {
            rectangle "Result Sorting & Filtering" as RSF
                rectangle "Result Caching" as RC
        }
    rectangle "Cache (Redis Cluster)" as Cache {
        rectangle "Search Result Cache" as SRC
    }
    rectangle "Search Index" as Index {
        rectangle "Elasticsearch" as ES
    }
}

Client -down-> RH : Sends Search Request
RH -down-> QP : Parses Query
QP -down-> IQ : Queries Index
IQ -down-> ES : Queries Elasticsearch
ES -down-> IQ : Returns Search Results
IQ -down-> RSF : Sorts & Filters Results
RSF -down-> RC : Caches Results
RC -down-> SRC : Stores in Cache
RC -down-> RH : Returns Results from Cache
RH -up-> Client : Returns Search Results

note right of Search
**性能优化**:
- 使用缓存（Redis）减少重复查询
- 使用Elasticsearch提高搜索查询速度
- 查询解析和结果排序优化
end note

@enduml
