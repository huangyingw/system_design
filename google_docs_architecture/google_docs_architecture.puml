@startuml Google Docs Architecture

skinparam backgroundColor #F5F5F5
skinparam defaultFontName Arial
skinparam defaultFontSize 12
skinparam titleFontSize 18
skinparam titleFontColor #333333
skinparam padding 5
skinparam roundCorner 10

title Google Docs Architecture

rectangle "Client Side" as ClientSide {
    [Web UI]
    [Mobile App]
    [Desktop App]
}

rectangle "Load Balancer" as LB

rectangle "Application Layer" {
    [Authentication Service]
    [Document Service]
    [Collaboration Service]
    [Search Service]
    [Notification Service]
    [Version Control Service]
}

rectangle "Real-time Collaboration" as RTC {
    [Operational Transform Engine]
    [WebSocket Server]
}

rectangle "Data Storage" {
    database "Document DB (NoSQL)" {
        [Document Data]
        note right: Sharding Key: doc_id
    }
    
    database "User DB (SQL)" {
        [User Data]
        note right: PK: user_id\nIndexes: email, username
    }
    
    database "Redis Cache" {
        [Session Data]
        [Document Cache]
        note right: Key: doc_id:version
    }
}

queue "Message Queue" {
    [RabbitMQ]
}

cloud "External Services" {
    [Email Service]
    [Analytics Service]
}

ClientSide -[#4CAF50,thickness=2]-> LB : <color:#4CAF50>1. HTTPS</color>
LB -[#2196F3,thickness=2]-> [Authentication Service] : <color:#2196F3>2. Auth</color>
LB -[#FF5722,thickness=2]-> [Document Service] : <color:#FF5722>3. Doc Ops</color>
[Document Service] -[#9C27B0,thickness=2]-> RTC : <color:#9C27B0>4. Real-time Updates</color>
[Document Service] -[#795548,thickness=2]-> [Document Data] : <color:#795548>5. CRUD</color>
[Document Service] -[#FFC107,thickness=2]-> [Document Cache] : <color:#FFC107>6. Cache</color>
[Collaboration Service] -[#00BCD4,thickness=2]-> [WebSocket Server] : <color:#00BCD4>7. Sync</color>
[Notification Service] -[#607D8B,thickness=2]-> [RabbitMQ] : <color:#607D8B>8. Queue</color>
[RabbitMQ] -[#8BC34A,thickness=2]-> [Email Service] : <color:#8BC34A>9. Send</color>

note right of RTC
  Ensures consistency and
  real-time collaboration
  across multiple users
end note

@enduml
