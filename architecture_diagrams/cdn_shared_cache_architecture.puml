@startuml
skinparam backgroundColor #D3D3D3
skinparam rectangle {
  BackgroundColor White
  BorderColor Black
  Shadowing false
}

package "CDN System" {
    rectangle "Global Load Balancer" as GLB
    rectangle "Geolocation Database" as GeoDB

    rectangle "CDN Node A" as CDNA {
        database "Cache A" as CacheA
    }
    rectangle "CDN Node B" as CDNB {
        database "Cache B" as CacheB
    }
    rectangle "Origin Server" as Origin

    rectangle "CDN Node C" as CDNC {
        database "Cache C" as CacheC
    }

    GLB --> GeoDB : "Geolocation Query"
    GeoDB -down-> CDNA : "Route Request"
    GeoDB -down-> CDNB
    GeoDB -down-> CDNC
    CDNA --> CacheA : "Request/Store Content"
    CDNB --> CacheB : "Request/Store Content"
    CDNC --> CacheC : "Request/Store Content"
    CacheA --> Origin : "Origin Fetch (if not cached)"
    CacheB --> Origin : "Origin Fetch (if not cached)"
    CacheC --> Origin : "Origin Fetch (if not cached)"
    CacheA ..> CacheB : "Shared Cache Query"
    CacheB ..> CacheC : "Shared Cache Query"
    CacheC ..> CacheA : "Shared Cache Query"
}

rectangle "User" as User
User -right-> GLB : "Request Content"

@enduml
