@startuml Kafka Cluster Architecture Overview
' ==================== Metadata ====================
' @category: message-queue
' @tags: #kafka, #zookeeper, #prometheus
' @application: General
' @tech-stack: Kafka, ZooKeeper, Prometheus, Grafana
' @pattern: Architecture
' @description: Kafka Cluster Architecture Overview
' ==================================================

!pragma layout dot
skinparam backgroundColor #F0F0F0
skinparam defaultFontName Arial
skinparam defaultFontSize 14
skinparam defaultFontColor #333333
skinparam roundcorner 20
skinparam shadowing false
skinparam ArrowColor #666666
skinparam ArrowThickness 2
allowmixing

' Color definitions
!define ZOOKEEPER_COLOR E6E6FA
!define BROKER_COLOR E0FFFF
!define COMPONENT_COLOR F0FFF0
!define MONITORING_COLOR FFF0F5
!define SECURITY_COLOR FFE4E1

' Zookeeper Ensemble
rectangle "Zookeeper Ensemble" as ZK #ZOOKEEPER_COLOR {
    component "ZK Node 1" as ZK1
    component "ZK Node 2" as ZK2
    component "ZK Node 3" as ZK3
}

' Kafka Cluster
rectangle "Kafka Cluster" as KC {
    rectangle "Broker 1" as B1 #BROKER_COLOR {
        component "Request Handler" as RH1 #COMPONENT_COLOR
        component "Network Processor" as NP1 #COMPONENT_COLOR
    }
    rectangle "Broker 2" as B2 #BROKER_COLOR {
        component "Request Handler" as RH2 #COMPONENT_COLOR
        component "Network Processor" as NP2 #COMPONENT_COLOR
    }
    rectangle "Broker 3 (Controller)" as B3 #BROKER_COLOR {
        component "Controller" as CTRL #COMPONENT_COLOR
        component "Replication Manager" as RM #COMPONENT_COLOR
        component "Log Manager" as LM #COMPONENT_COLOR
    }
    rectangle "Broker 4" as B4 #BROKER_COLOR {
        component "Request Handler" as RH4 #COMPONENT_COLOR
        component "Network Processor" as NP4 #COMPONENT_COLOR
    }
}

' Monitoring & Management
rectangle "Monitoring & Management" as MM #MONITORING_COLOR {
    component "Kafka Manager" as KM
    component "JMX Exporter" as JMX
    component "Prometheus" as PROM
    component "Grafana" as GRAF
}

' Security Layer
rectangle "Security Layer" as SL #SECURITY_COLOR {
    component "SSL/TLS" as SSL
    component "SASL" as SASL
    component "ACL" as ACL
}

' Connections
ZK -[#4B0082,thickness=2]down-> KC : <color:#4B0082><b>1. Coordinates</b></color>
B3 -[#006400,thickness=2]up-> ZK : <color:#006400><b>2. Manages</b></color>
KC -[#4682B4,thickness=2]right-> MM : <color:#4682B4><b>3. Monitored by</b></color>
KC -[#8B4513,thickness=2]-> SL : <color:#8B4513><b>4. Secured by</b></color>

' Notes
note right of B3 #FFFAFA
  <b>Controller Broker:</b>
  Manages cluster-wide operations
  Performance bottleneck: Consider implementing
  multi-controller for high availability
end note

note bottom of MM #FFFAFA
  Provides insights and facilitates cluster management
  Optimization: Implement automated alerting and
  self-healing mechanisms
end note

note bottom of SL #FFFAFA
  Ensures secure communication and access control
  Consider implementing rotating keys and
  certificate management for enhanced security
end note

@enduml