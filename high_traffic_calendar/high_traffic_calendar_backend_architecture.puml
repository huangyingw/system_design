@startuml

package "Web Services" {
  [API Gateway]
  [Web Server: Django/Flask/FastAPI]
  [Task Queue: Celery]
}

package "Databases" {
  [Primary DB: PostgreSQL/MySQL]
  [Cache: Redis]
  [Search Engine: Elasticsearch]
}

package "Load Balancer" {
  [Nginx/HAProxy]
}

package "Workers" {
  [Worker: Celery]
}

actor User

User --> "API Gateway": Request
"API Gateway" --> "Web Server": Request
"Web Server" --> "Cache": Check Cache
note right of "Cache"
  If Cache Miss:
    1. Web Server queries Primary DB
    2. Primary DB returns data
    3. Web Server updates Cache
  If Cache Hit:
    Cache returns data directly
end note
"Web Server" <-- "Primary DB": Return Data (if Cache Miss)
"Web Server" --> "Search Engine": Search
"Task Queue" --> "Worker": Send Tasks
"Worker" --> "Primary DB": Query
"Worker" --> "Cache": Invalidate Cache

@enduml
