@startuml

actor User

rectangle "API Gateway" {
  [Create Event]
  [Update Event]
  [Delete Event]
  [Get Events]
}

rectangle "Web Server" {
  [Business Logic]
}

rectangle "MongoDB Cluster" {
  [Query Routers (mongos)]
  [Primary Node]
  [Secondary Node]
}

rectangle "Cache" {
  [Redis]
}

User --> "API Gateway": Request
"API Gateway" --> "Web Server": Forward Request
"Web Server" --> "Cache": Check Cache (for Get Events)
"Cache" --> "Web Server": Cache Hit
"Web Server" --> "Query Routers (mongos)": Cache Miss (Read Request)
"Web Server" --> "Query Routers (mongos)": Write Request
"Query Routers (mongos)" --> "Secondary Node": Read Request
"Query Routers (mongos)" --> "Primary Node": Write Request
"Primary Node" --> "Secondary Node": Replicate Data

@enduml
