@startuml Distributed Search Engine

!include common_style.puml

title Distributed Search Engine with Ranking and Relevance

rectangle "Client Interface" {
    component "Search API Gateway" as apiGateway
    component "Query Parser" as queryParser
    component "Result Formatter" as resultFormatter
}

rectangle "Query Processing" {
    component "Query Analyzer" as queryAnalyzer
    component "Query Rewriter" as queryRewriter
    component "Query Planner" as queryPlanner
}

rectangle "Search Core" {
    component "Document Processor" as docProcessor
    component "Indexer" as indexer
    component "Search Executor" as searchExecutor
    component "Ranking Engine" as rankingEngine
}

rectangle "Crawler System" {
    component "URL Frontier" as urlFrontier
    component "Crawler Manager" as crawlerManager
    component "HTML Parser" as htmlParser
    component "Link Extractor" as linkExtractor
}

rectangle "Storage Layer" {
    database "Document Store\n(MongoDB)" as documentStore
    database "Inverted Index\n(Elasticsearch)" as invertedIndex
    database "URL Store\n(PostgreSQL)" as urlStore
    database "Cache Layer\n(Redis)" as cacheLayer
}

rectangle "Data Processing" {
    queue "Document Queue\n(Kafka)" as docQueue
    component "Feature Extractor" as featureExtractor
    component "Text Analyzer" as textAnalyzer
    component "Language Detector" as langDetector
}

' Connections
apiGateway --> queryParser
queryParser --> queryAnalyzer
queryAnalyzer --> queryRewriter
queryRewriter --> queryPlanner
queryPlanner --> searchExecutor

searchExecutor --> invertedIndex
searchExecutor --> cacheLayer
searchExecutor --> rankingEngine
rankingEngine --> documentStore

crawlerManager --> urlFrontier
crawlerManager --> htmlParser
htmlParser --> linkExtractor
linkExtractor --> urlFrontier
htmlParser --> docQueue

docQueue --> docProcessor
docProcessor --> textAnalyzer
textAnalyzer --> langDetector
textAnalyzer --> featureExtractor
docProcessor --> indexer
indexer --> invertedIndex
indexer --> documentStore

urlFrontier --> urlStore

note right of rankingEngine
  PageRank calculation
  Relevance scoring
  Personalization
end note

note right of queryRewriter
  Query expansion
  Spell correction
  Synonym handling
end note

note right of docProcessor
  Document parsing
  Feature extraction
  Content classification
end note

note right of invertedIndex
  Distributed index
  Shard management
  Real-time updates
end note

@enduml 