@startuml Message Queue System Design

skinparam backgroundColor #F0F8FF
skinparam handwritten false
skinparam defaultFontName Arial
skinparam defaultFontSize 12
skinparam roundcorner 20
skinparam shadowing true

title 高可用消息队列系统设计

' 生产者
RECTANGLE "生产者集群" as Producers {
    [Producer 1]
    [Producer 2]
    [Producer N]
}

' 消费者
RECTANGLE "消费者集群" as Consumers {
    [Consumer 1]
    [Consumer 2]
    [Consumer N]
}

' 消息代理集群
RECTANGLE "消息代理集群" as Brokers {
    RECTANGLE "Broker 1" as Broker1 {
        queue "Topic 1" as Topic1_1
        queue "Topic 2" as Topic2_1
    }
    RECTANGLE "Broker 2" as Broker2 {
        queue "Topic 1" as Topic1_2
        queue "Topic 2" as Topic2_2
    }
    RECTANGLE "Broker 3" as Broker3 {
        queue "Topic 1" as Topic1_3
        queue "Topic 2" as Topic2_3
    }
}

' ZooKeeper集群
RECTANGLE "ZooKeeper集群" as ZK {
    [ZK Node 1]
    [ZK Node 2]
    [ZK Node 3]
}

' 监控和管理
RECTANGLE "监控和管理" as Monitoring {
    [性能监控]
    [告警系统]
    [管理控制台]
}

' 持久化存储
database "消息存储" as Storage {
    [Commit Log]
}

Producers -down-> Brokers : 发送消息
Brokers -down-> Consumers : 投递消息
Brokers -right-> Storage : 持久化
ZK -up-> Brokers : 集群协调
Monitoring -up-> Brokers : 监控和管理

@enduml
