@startuml Distributed File System Architecture

skinparam backgroundColor #F0F0E0
skinparam handwritten false
skinparam monochrome false
skinparam defaultFontName Arial
skinparam defaultFontSize 12
skinparam roundCorner 10
skinparam ArrowColor #2C3E50
skinparam ArrowThickness 1.5
skinparam linetype ortho

!define RECTANGLE rectangle
!define DATABASE database

' Client nodes
rectangle "Client A" as ClientA #A9CCE3
rectangle "Client B" as ClientB #A9CCE3

' Load Balancer
RECTANGLE "Load Balancer" as LB #F5B041 {
    component "Health Check" as HealthCheck
}

' Caching Layer
RECTANGLE "Caching Layer" as CacheLayer #85C1E9 {
    DATABASE "Redis Cluster" as RedisCache
}

' Name Node Cluster
RECTANGLE "Name Node Cluster" as NameNodeCluster #82E0AA {
    DATABASE "Metadata Storage\n(Aurora)" as MetadataStorage
    component "File System Tree" as FSTree
    component "Block Management" as BlockMgmt
}

' Data Nodes
RECTANGLE "Data Node 1" as DataNode1 #F1948A {
    DATABASE "Data Storage 1" as DataStorage1
    component "Data Replication" as Replication1
}

RECTANGLE "Data Node 2" as DataNode2 #F1948A {
    DATABASE "Data Storage 2" as DataStorage2
    component "Data Replication" as Replication2
}

' Admin Node
RECTANGLE "Admin Node" as AdminNode #D7BDE2 {
    component "Monitoring" as Monitoring
    component "Configuration" as Config
}

' Backup Node
RECTANGLE "Backup Node" as BackupNode #FAD7A0 {
    DATABASE "Backup Storage" as BackupStorage
    component "Recovery Management" as RecoveryMgmt
}

' Block Metadata
DATABASE "Block Metadata\n(MongoDB)" as BlockMetadataDB #AED6F1

' Layout
ClientA -[hidden]right- ClientB
ClientA -[hidden]down- LB
ClientB -[hidden]down- LB
LB -[hidden]down- CacheLayer
CacheLayer -[hidden]right- NameNodeCluster
NameNodeCluster -[hidden]right- BlockMetadataDB
DataNode1 -[hidden]right- DataNode2
DataNode1 -[hidden]down- BackupNode
DataNode2 -[hidden]down- BackupNode
AdminNode -[hidden]left- BackupNode

' Connections
ClientA -down-> LB : "1. Request"
ClientB -down-> LB : "1. Request"
LB -down-> CacheLayer : "2. Check\nCache"
CacheLayer -right-> NameNodeCluster : "3. Cache\nMiss"
NameNodeCluster -down-> DataNode1 : "4. Assign\nTask"
NameNodeCluster -down-> DataNode2 : "4. Assign\nTask"
DataNode1 -up-> CacheLayer : "5. Update\nCache"
DataNode2 -up-> CacheLayer : "5. Update\nCache"
ClientA .[#blue].> DataNode1 : "6. Read/Write\nData"
ClientB .[#blue].> DataNode2 : "6. Read/Write\nData"
DataNode1 -down-> BackupNode : "7. Data\nBackup"
DataNode2 -down-> BackupNode : "7. Data\nBackup"
AdminNode -up-> NameNodeCluster : "8. Manage &\nMonitor"
AdminNode -up-> DataNode1 : "8. Manage &\nMonitor"
AdminNode -up-> DataNode2 : "8. Manage &\nMonitor"
NameNodeCluster -right-> BlockMetadataDB : "9. Store/Retrieve\nBlock Metadata"

@enduml
